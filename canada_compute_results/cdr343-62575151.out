
Due to MODULEPATH changes, the following have been reloaded:
  1) libfabric/1.10.1     2) openmpi/4.0.3     3) ucx/1.8.0

2023-03-15 09:19:08.633729: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-15 09:20:56.490604: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-03-15 09:20:56.534817: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-03-15 09:20:56.534920: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-03-15 09:23:12.623146: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-15 09:23:34.924130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 11306 MB memory:  -> device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:04:00.0, compute capability: 6.0
2023-03-15 09:23:42.206378: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:428] Loaded cuDNN version 8200
2023-03-15 09:23:42.916147: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:115] *** WARNING *** You are using ptxas 11.0.194, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
All model checkpoint layers were used when initializing TFViTModel.

All the layers of TFViTModel were initialized from the model checkpoint at google/vit-base-patch16-224-in21k.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFViTModel for predictions without further training.
Number of Train Pairs: 3859
Number of Validation Pairs: 1287
Model: "siamese_network"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 pixel_values1 (InputLayer)     [(None, 224, 224, 3  0           []                               
                                )]                                                                
                                                                                                  
 pixel_values2 (InputLayer)     [(None, 224, 224, 3  0           []                               
                                )]                                                                
                                                                                                  
 permute (Permute)              (None, 3, 224, 224)  0           ['pixel_values1[0][0]']          
                                                                                                  
 permute_1 (Permute)            (None, 3, 224, 224)  0           ['pixel_values2[0][0]']          
                                                                                                  
 vit (TFViTMainLayer)           TFBaseModelOutputWi  86389248    ['permute[0][0]',                
                                thPooling(last_hidd               'permute_1[0][0]']              
                                en_state=(None, 197                                               
                                , 768),                                                           
                                 pooler_output=(Non                                               
                                e, 768),                                                          
                                 hidden_states=None                                               
                                , attentions=None)                                                
                                                                                                  
 l1_dist (L1Dist)               (None, 768)          0           ['vit[0][1]',                    
                                                                  'vit[1][1]']                    
                                                                                                  
 outputs (Dense)                (None, 1)            769         ['l1_dist[0][0]']                
                                                                                                  
==================================================================================================
Total params: 86,390,017
Trainable params: 86,390,017
Non-trainable params: 0
__________________________________________________________________________________________________
2023-03-15 09:25:29.576560: I tensorflow/compiler/xla/service/service.cc:173] XLA service 0x2b4e5004a230 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2023-03-15 09:25:29.577518: I tensorflow/compiler/xla/service/service.cc:181]   StreamExecutor device (0): Tesla P100-PCIE-12GB, Compute Capability 6.0
2023-03-15 09:25:33.036467: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2023-03-15 09:25:43.954547: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:115] *** WARNING *** You are using ptxas 11.0.194, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
2023-03-15 09:25:44.192669: I tensorflow/compiler/jit/xla_compilation_cache.cc:477] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2023-03-15 09:25:44.706588: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:115] *** WARNING *** You are using ptxas 11.0.194, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
2023-03-15 09:25:44.975316: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:115] *** WARNING *** You are using ptxas 11.0.194, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
2023-03-15 09:25:46.173429: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:115] *** WARNING *** You are using ptxas 11.0.194, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
2023-03-15 09:26:11.429095: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:115] *** WARNING *** You are using ptxas 11.0.194, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
  1/241 [..............................] - ETA: 8:14:42 - loss: 0.2382 - accuracy: 0.5625  2/241 [..............................] - ETA: 5:38 - loss: 0.2636 - accuracy: 0.4688     3/241 [..............................] - ETA: 7:05 - loss: 0.2611 - accuracy: 0.4792  4/241 [..............................] - ETA: 7:18 - loss: 0.2590 - accuracy: 0.4844  5/241 [..............................] - ETA: 7:35 - loss: 0.2596 - accuracy: 0.4625  6/241 [..............................] - ETA: 7:38 - loss: 0.2573 - accuracy: 0.5208  7/241 [..............................] - ETA: 7:33 - loss: 0.2555 - accuracy: 0.5446  8/241 [..............................] - ETA: 7:17 - loss: 0.2559 - accuracy: 0.5312  9/241 [>.............................] - ETA: 6:58 - loss: 0.2548 - accuracy: 0.5417 10/241 [>.............................] - ETA: 7:00 - loss: 0.2548 - accuracy: 0.5375 11/241 [>.............................] - ETA: 6:49 - loss: 0.2543 - accuracy: 0.5284 12/241 [>.............................] - ETA: 6:33 - loss: 0.2536 - accuracy: 0.5417 13/241 [>.............................] - ETA: 6:28 - loss: 0.2529 - accuracy: 0.5385 14/241 [>.............................] - ETA: 6:42 - loss: 0.2531 - accuracy: 0.5402 15/241 [>.............................] - ETA: 6:28 - loss: 0.2525 - accuracy: 0.5375 16/241 [>.............................] - ETA: 6:39 - loss: 0.2519 - accuracy: 0.5469 17/241 [=>............................] - ETA: 6:42 - loss: 0.2520 - accuracy: 0.5404 18/241 [=>............................] - ETA: 6:36 - loss: 0.2541 - accuracy: 0.5417 19/241 [=>............................] - ETA: 6:30 - loss: 0.2532 - accuracy: 0.5493 20/241 [=>............................] - ETA: 6:22 - loss: 0.2532 - accuracy: 0.5437 21/241 [=>............................] - ETA: 6:14 - loss: 0.2529 - accuracy: 0.5417 22/241 [=>............................] - ETA: 6:07 - loss: 0.2528 - accuracy: 0.5369 23/241 [=>............................] - ETA: 6:17 - loss: 0.2526 - accuracy: 0.5353 24/241 [=>............................] - ETA: 6:07 - loss: 0.2522 - accuracy: 0.5417 25/241 [==>...........................] - ETA: 6:03 - loss: 0.2521 - accuracy: 0.5375 26/241 [==>...........................] - ETA: 5:59 - loss: 0.2519 - accuracy: 0.5433 27/241 [==>...........................] - ETA: 5:51 - loss: 0.2514 - accuracy: 0.5486 28/241 [==>...........................] - ETA: 5:56 - loss: 0.2514 - accuracy: 0.5469 29/241 [==>...........................] - ETA: 5:48 - loss: 0.2516 - accuracy: 0.5474 30/241 [==>...........................] - ETA: 5:50 - loss: 0.2513 - accuracy: 0.5479 31/241 [==>...........................] - ETA: 5:42 - loss: 0.2510 - accuracy: 0.5444 32/241 [==>...........................] - ETA: 5:40 - loss: 0.2503 - accuracy: 0.5508 33/241 [===>..........................] - ETA: 5:33 - loss: 0.2501 - accuracy: 0.5473 34/241 [===>..........................] - ETA: 5:27 - loss: 0.2502 - accuracy: 0.5460 35/241 [===>..........................] - ETA: 5:23 - loss: 0.2495 - accuracy: 0.5464 36/241 [===>..........................] - ETA: 5:36 - loss: 0.2493 - accuracy: 0.5399 37/241 [===>..........................] - ETA: 5:30 - loss: 0.2494 - accuracy: 0.5405 38/241 [===>..........................] - ETA: 5:26 - loss: 0.2494 - accuracy: 0.5395 39/241 [===>..........................] - ETA: 5:20 - loss: 0.2490 - accuracy: 0.5433 40/241 [===>..........................] - ETA: 5:14 - loss: 0.2488 - accuracy: 0.5437 41/241 [====>.........................] - ETA: 5:09 - loss: 0.2486 - accuracy: 0.5442 42/241 [====>.........................] - ETA: 5:04 - loss: 0.2485 - accuracy: 0.5432 43/241 [====>.........................] - ETA: 5:00 - loss: 0.2482 - accuracy: 0.5436 44/241 [====>.........................] - ETA: 4:58 - loss: 0.2482 - accuracy: 0.5426 45/241 [====>.........................] - ETA: 4:54 - loss: 0.2476 - accuracy: 0.5472 46/241 [====>.........................] - ETA: 4:50 - loss: 0.2468 - accuracy: 0.5503 47/241 [====>.........................] - ETA: 4:47 - loss: 0.2464 - accuracy: 0.5519 48/241 [====>.........................] - ETA: 4:44 - loss: 0.2468 - accuracy: 0.5534 49/241 [=====>........................] - ETA: 4:40 - loss: 0.2466 - accuracy: 0.5561 50/241 [=====>........................] - ETA: 4:36 - loss: 0.2479 - accuracy: 0.5550 51/241 [=====>........................] - ETA: 4:32 - loss: 0.2480 - accuracy: 0.5551 52/241 [=====>........................] - ETA: 4:29 - loss: 0.2486 - accuracy: 0.5553 53/241 [=====>........................] - ETA: 4:26 - loss: 0.2487 - accuracy: 0.5554 54/241 [=====>........................] - ETA: 4:24 - loss: 0.2488 - accuracy: 0.5544 55/241 [=====>........................] - ETA: 4:21 - loss: 0.2489 - accuracy: 0.5523 56/241 [=====>........................] - ETA: 4:19 - loss: 0.2489 - accuracy: 0.5502 57/241 [======>.......................] - ETA: 4:16 - loss: 0.2489 - accuracy: 0.5482 58/241 [======>.......................] - ETA: 4:13 - loss: 0.2489 - accuracy: 0.5506 59/241 [======>.......................] - ETA: 4:10 - loss: 0.2489 - accuracy: 0.5487 60/241 [======>.......................] - ETA: 4:08 - loss: 0.2489 - accuracy: 0.5510 61/241 [======>.......................] - ETA: 4:07 - loss: 0.2489 - accuracy: 0.5482 62/241 [======>.......................] - ETA: 4:04 - loss: 0.2489 - accuracy: 0.5484 63/241 [======>.......................] - ETA: 4:01 - loss: 0.2490 - accuracy: 0.5476 64/241 [======>.......................] - ETA: 4:02 - loss: 0.2490 - accuracy: 0.5469 65/241 [=======>......................] - ETA: 3:59 - loss: 0.2490 - accuracy: 0.5471 66/241 [=======>......................] - ETA: 3:56 - loss: 0.2490 - accuracy: 0.5502 67/241 [=======>......................] - ETA: 3:53 - loss: 0.2489 - accuracy: 0.5476 68/241 [=======>......................] - ETA: 3:50 - loss: 0.2489 - accuracy: 0.5487 69/241 [=======>......................] - ETA: 3:48 - loss: 0.2488 - accuracy: 0.5489 70/241 [=======>......................] - ETA: 3:47 - loss: 0.2488 - accuracy: 0.5491 71/241 [=======>......................] - ETA: 3:45 - loss: 0.2488 - accuracy: 0.5528 72/241 [=======>......................] - ETA: 3:42 - loss: 0.2488 - accuracy: 0.5538 73/241 [========>.....................] - ETA: 3:40 - loss: 0.2489 - accuracy: 0.5514 74/241 [========>.....................] - ETA: 3:37 - loss: 0.2491 - accuracy: 0.5498 75/241 [========>.....................] - ETA: 3:35 - loss: 0.2488 - accuracy: 0.5525 76/241 [========>.....................] - ETA: 3:32 - loss: 0.2487 - accuracy: 0.5543 77/241 [========>.....................] - ETA: 3:30 - loss: 0.2485 - accuracy: 0.5560 78/241 [========>.....................] - ETA: 3:28 - loss: 0.2483 - accuracy: 0.5585 79/241 [========>.....................] - ETA: 3:25 - loss: 0.2486 - accuracy: 0.5554 80/241 [========>.....................] - ETA: 3:23 - loss: 0.2485 - accuracy: 0.5570 81/241 [=========>....................] - ETA: 3:21 - loss: 0.2489 - accuracy: 0.5556 82/241 [=========>....................] - ETA: 3:19 - loss: 0.2489 - accuracy: 0.5564 83/241 [=========>....................] - ETA: 3:17 - loss: 0.2490 - accuracy: 0.5542 84/241 [=========>....................] - ETA: 3:15 - loss: 0.2489 - accuracy: 0.5551 85/241 [=========>....................] - ETA: 3:13 - loss: 0.2488 - accuracy: 0.5581 86/241 [=========>....................] - ETA: 3:11 - loss: 0.2488 - accuracy: 0.5581 87/241 [=========>....................] - ETA: 3:09 - loss: 0.2486 - accuracy: 0.5582 88/241 [=========>....................] - ETA: 3:07 - loss: 0.2485 - accuracy: 0.5597 89/241 [==========>...................] - ETA: 3:05 - loss: 0.2484 - accuracy: 0.5611 90/241 [==========>...................] - ETA: 3:03 - loss: 0.2483 - accuracy: 0.5625 91/241 [==========>...................] - ETA: 3:03 - loss: 0.2481 - accuracy: 0.5639 92/241 [==========>...................] - ETA: 3:01 - loss: 0.2483 - accuracy: 0.5632 93/241 [==========>...................] - ETA: 2:59 - loss: 0.2482 - accuracy: 0.5638 94/241 [==========>...................] - ETA: 2:57 - loss: 0.2481 - accuracy: 0.5638 95/241 [==========>...................] - ETA: 2:56 - loss: 0.2479 - accuracy: 0.5651 96/241 [==========>...................] - ETA: 2:54 - loss: 0.2477 - accuracy: 0.5664 97/241 [===========>..................] - ETA: 2:53 - loss: 0.2480 - accuracy: 0.5657